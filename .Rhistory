Sys.getenv("DOWNLOAD_MPEDS")
?st_split
library(lwgeom)
?st_split
library(sf)
?st_split
library(lwgeom)
install.packages("lwgeom")
library(lwgeom)
?st_split
?st_linesubstring
dta <- c("data/raw/gadm36_KOR_2_sf.rds", "data/raw/gadm36_PRK_2_sf.rds") %>%
map_dfr(\(file) {
shp <- readRDS(file)
st_crs(shp) <-
st_crs(shp) # handle "old-style" projection warnings
return(shp)
}) %>%
st_union() %>%
ms_simplify(keep = 0.04)
library(tidyverse)
library(sf)
library(rmapshaper)
install.packages("rmapshaper")
?st_simplify
dta <- c("data/raw/gadm36_KOR_2_sf.rds", "data/raw/gadm36_PRK_2_sf.rds") %>%
map_dfr(\(file) {
shp <- readRDS(file)
st_crs(shp) <-
st_crs(shp) # handle "old-style" projection warnings
return(shp)
}) %>%
st_union() %>%
st_simplify()
install.packages("rmapshaper")
install.packages("rmapshaper")
library(sf)
library(rmapshaper)
dta <- c("data/raw/gadm36_KOR_2_sf.rds", "data/raw/gadm36_PRK_2_sf.rds") %>%
map_dfr(\(file) {
shp <- readRDS(file)
st_crs(shp) <-
st_crs(shp) # handle "old-style" projection warnings
return(shp)
}) %>%
st_union() %>%
ms_simplify(keep = 0.04)
setwd("main/personal/projects/korea-culture-critique/data")
setwd("..")
dta <- c("data/raw/gadm36_KOR_2_sf.rds", "data/raw/gadm36_PRK_2_sf.rds") %>%
map_dfr(\(file) {
shp <- readRDS(file)
st_crs(shp) <-
st_crs(shp) # handle "old-style" projection warnings
return(shp)
}) %>%
st_union() %>%
ms_simplify(keep = 0.04)
dta
st_split(dta)
?st_split
st_cast(dta, "MULTILINESTRING")
st_cast(dta, "MULTILINESTRING") |> plot()
st_cast(dta, "MULTILINESTRING")[[1]]
st_cast(dta, "MLINESTRING")
st_cast(dta, "LINESTRING")
st_cast(dta, "MULTILINESTRING") |> st_cast("LINESTRING")
st_cast(dta, "MULTILINESTRING") |> st_cast("LINESTRING") -> y
y[612,]
y[612]
y[612] |> plot()
map(y, st_length)
map(y, st_length) |> unlist() |> which.max()
y[611] |> plot()
?st_linesubstring
split_linestring <- map(seq(0, 1, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1))
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 1, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1))
return()
}
})
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 1, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1))
return()
}
})
linestrings |> length()
linestrings[612]
linestrings[612] |> st_length()
linestrings[612][[1]] |> st_length()
linestrings[611][[1]] |> st_length()
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 1, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1))
return(split_linestring)
}
})
linestrings[611][[1]] |> st_length()
linestrings[611][[1]]
?st_multilinestring
linestrings[611][[1]] |> st_multilinestring()
linestrings[611][[1]][1]
linestrings[611][[1]][[1]]
linestrings[611][[1]][[1]] |> class()
linestrings[611][[1]][[1]] |> as.matrix()
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(split_linestring)
}
})
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(split_linestring)
}
})
linestrings[611][[1]]
linestrings[611][[1]] |> st_multilinestring()
linestrings[611][[1]] |> st_multilinestring() |> plot()
linestrings |> flatten()
?flatten
x <- list(
list(),
list(list())
)
x
x |> pluck_depth()
?pluck_depth
x |> list_flatten()
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(linestring)
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
})
linestrings |> class()
linestrings |> st_as_sf()
linestrings |> st_multilinestring()
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(as.matrix(linestring))
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
})
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(as.matrix(linestring))
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
}) |>
st_multilinestring()
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(as.matrix(linestring))
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
}) |>
st_multilinestring()
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(as.matrix(linestring))
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
})
linestrings <- dta %>%
st_cast("MULTILINESTRING") %>%
st_cast("LINESTRING")
linestrings <- linestrings %>%
map(\(linestring){
if(st_length(linestring) < 1){
return(as.matrix(linestring))
} else {
split_linestring <- map(seq(0, 0.9, by = 0.1),
~st_linesubstring(
linestring,
from = .,
to = . + 0.1) |> as.matrix())
return(st_multilinestring(split_linestring))
}
})
linestrings[1]
linestrings[2]
linestrings[1:3] |> st_multilinestring()
linestrings[1:100] |> st_multilinestring()
linestrings[1:50] |> st_multilinestring()
linestrings[1:75] |> st_multilinestring()
linestrings[1:63] |> st_multilinestring()
linestrings[1:68] |> st_multilinestring()
linestrings[1:67] |> st_multilinestring()
linestrings[1:66] |> st_multilinestring()
linestrings[1:6] |> st_multilinestring()
linestrings[1:65] |> st_multilinestring()
linestrings[1:66] |> st_multilinestring()
linestrings[66]
?reduce
